---
title: "STAT 184 Final Project"
names: "Mackenzie Johnson & Isabella Santori"
output: html_notebook
---

```{r}
# clean up the RStudio environment 
rm(list = ls())

# load all packages
library(mosaic)
library(tidyverse)
library(lubridate)
library(DataComputing)
```

Research Question: How have athletes preformances changed overtime when looking at Olympic Games data? 
### Load Primary Data Source into RNotebook
```{r}
#Primary Data Soucre
olympicAthleteData <- read.csv(file.choose())
glimpse(olympicAthleteData)
```
This data set contains information about every athlete that has competed in the Olympics. A case is an Olympic athlete and there are 15 variables to describe each athlete and their participation in the Olympics. 

### Load Secondary Data Source into RNotebook
```{r}
library(rvest)
page <- "https://en.wikipedia.org/wiki/List_of_Olympic_records_in_athletics"
tableList <- page %>%
  read_html() %>%
  html_nodes(css = "table") %>%
  html_table(fill = TRUE)

glimpse(tableList[[1]])
glimpse(tableList[[2]])
```
These lists are from Wikipedia and they are a list of both the male and female current olympic records in the track and field events. Each case represents a different event and then has the current record and the athlete who currently hold that record. The tablelist 1 is the male records and the tablelist 2 is the female records. 

# Data Wrangling 
### Regular Expression of Olympic Records table 
```{r}
malerecords<- tableList[[1]]
femalerecords<- tableList[[2]]

malerecords <- 
  malerecords %>%
    filter(grepl(pattern = "\\d*metres$", Event)) %>%
    mutate(Record = ms(Record))
malerecords

femalerecords <-
  femalerecords %>%
    filter(grepl(pattern = "\\d*metres$", Event)) %>%
    mutate(Record = ms(Record))
femalerecords
```

### Joining Two Data Tables
```{r}
SprintingRecords <-
  malerecords %>%
    full_join(femalerecords)
SprintingRecords
```

### Using Data Verbs on primary data set
```{r}
olympicAthleteData <-
  olympicAthleteData%>%
  select(Name, Sex, Age, Team, Year, Sport, Event, Medal)%>%
  filter(Sport == "Athletics") %>%
  mutate(Name = as.character(Name),
         Sex = as.character(Sex),
         Sport = as.character(Sport),
         Event = as.character(Event),
         Medal = as.character(Medal)) %>%
  filter(grepl(pattern = "\\d*metres$", Event)) %>%
  mutate(Event = (gsub(pattern = "Athletics Women's|Athletics Men's", replacement = "", Event))) %>%
  rename("Athlete(s)" = Name) %>%
  rename("Nation" = Team)

olympicAthleteData
```

